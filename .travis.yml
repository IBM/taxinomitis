language: node_js
node_js:
- "10"

env:
  global:
    - POSTGRESQLUSER=ml4k
    - POSTGRESQLPASSWORD=testdbpwd
    - POSTGRESQLDATABASE=mlforkidsdb
    - POSTGRESQLHOST=localhost
    - POSTGRESQLPORT=5433
    - DEPLOYMENT=travis

addons:
  postgresql: "12"
  apt:
    packages:
    - postgresql-12
    - postgresql-client-12

before_script:
- psql -U postgres -p 5433 -c "CREATE USER ml4k WITH PASSWORD 'testdbpwd' LOGIN;"
- psql -U postgres -p 5433 -c "CREATE DATABASE mlforkidsdb OWNER ml4k;"
- psql -U ml4k -p 5433 -f sql/postgresql.sql mlforkidsdb
- psql -U ml4k -p 5433 -c "ALTER DATABASE mlforkidsdb SET search_path to mlforkidsdb;"

script:
- npm run build
