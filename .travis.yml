language: node_js
node_js:
- "10"

env:
  global:
    - POSTGRESQLUSER=ml4k
    - POSTGRESQLPASSWORD=testdbpwd
    - POSTGRESQLDATABASE=mlforkidsdb
    - POSTGRESQLHOST=localhost
    - POSTGRESQLPORT=5432
    - DEPLOYMENT=travis

services:
- postgresql

addons:
  postgresql: "12"

before_install:
- psql -c 'CREATE USER ml4k WITH PASSWORD testdbpwd;' -U postgres
- psql -c 'CREATE DATABASE mlforkidsdb WITH OWNER = ml4k;' -U postgres
- psql -f sql/postgresql.sql -U postgres
- psql -c 'ALTER DATABASE mlforkidsdb SET search_path to mlforkidsdb;'

script:
- npm run build
