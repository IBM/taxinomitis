language: node_js
node_js:
- "10"

env:
  global:
    - POSTGRESQLUSER=ml4k
    - POSTGRESQLPASSWORD=testdbpwd
    - POSTGRESQLDATABASE=mlforkidsdb
    - POSTGRESQLHOST=localhost
    - POSTGRESQLPORT=5433
    - DEPLOYMENT=travis

services:
- postgresql

addons:
  postgresql: "12"
  apt:
    packages:
    - postgresql-12
    - postgresql-client-12

before_script:
- psql -c 'CREATE USER ml4k WITH PASSWORD testdbpwd;' -U postgres -p 5433
- psql -c 'CREATE DATABASE mlforkidsdb WITH OWNER = ml4k;' -U postgres -p 5433
- psql -f sql/postgresql.sql -U postgres -p 5433
- psql -c 'ALTER DATABASE mlforkidsdb SET search_path to mlforkidsdb;' -p 5433

script:
- npm run build
